{"paragraphs":[{"text":"%spark\n\nimport org.apache\n\nimport org.apache.spark.sql.SparkSession\n\nval spark = SparkSession.builder().appName(\"pca\").getOrCreate()\n\nval data = spark.read.option(\"header\",\"true\").option(\"inferSchema\",\"true\").format(\"csv\").load(\"/Users/ritvikreddykandanelly/Downloads/kc_house_data.csv\").drop(\"date\")\n\ndata.printSchema()\n\nval colnames=(Array(\"bedrooms\", \"bathrooms\", \"sqft_living\",\n       \"sqft_lot\", \"floors\", \"waterfront\", \"view\", \"condition\", \"grade\",\n       \"sqft_above\", \"sqft_basement\", \"yr_built\", \"yr_renovated\", \"zipcode\",\n       \"lat\", \"long\", \"sqft_living15\", \"sqft_lot15\"))","user":"anonymous","dateUpdated":"2019-04-07T14:40:01-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- id: long (nullable = true)\n |-- price: decimal(7,0) (nullable = true)\n |-- bedrooms: integer (nullable = true)\n |-- bathrooms: double (nullable = true)\n |-- sqft_living: integer (nullable = true)\n |-- sqft_lot: integer (nullable = true)\n |-- floors: double (nullable = true)\n |-- waterfront: integer (nullable = true)\n |-- view: integer (nullable = true)\n |-- condition: integer (nullable = true)\n |-- grade: integer (nullable = true)\n |-- sqft_above: integer (nullable = true)\n |-- sqft_basement: integer (nullable = true)\n |-- yr_built: integer (nullable = true)\n |-- yr_renovated: integer (nullable = true)\n |-- zipcode: integer (nullable = true)\n |-- lat: double (nullable = true)\n |-- long: double (nullable = true)\n |-- sqft_living15: integer (nullable = true)\n |-- sqft_lot15: integer (nullable = true)\n\nimport org.apache\nimport org.apache.spark.sql.SparkSession\nspark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@3334f791\ndata: org.apache.spark.sql.DataFrame = [id: bigint, price: decimal(7,0) ... 18 more fields]\ncolnames: Array[String] = Array(bedrooms, bathrooms, sqft_living, sqft_lot, floors, waterfront, view, condition, grade, sqft_above, sqft_basement, yr_built, yr_renovated, zipcode, lat, long, sqft_living15, sqft_lot15)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://10.110.60.241:4040/jobs/job?id=0","http://10.110.60.241:4040/jobs/job?id=1"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1554176865924_1172349243","id":"20190401-234745_1078732114","dateCreated":"2019-04-01T23:47:45-0400","dateStarted":"2019-04-07T14:40:01-0400","dateFinished":"2019-04-07T14:40:06-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:34553"},{"text":"%md\n\n## Importing the packages","user":"anonymous","dateUpdated":"2019-04-07T00:14:47-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Importing the packages</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1554245746015_-44419719","id":"20190402-185546_1962404835","dateCreated":"2019-04-02T18:55:46-0400","dateStarted":"2019-04-07T00:14:47-0400","dateFinished":"2019-04-07T00:14:47-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34554"},{"text":"%spark\nimport org.apache.spark.ml._\n\nimport org.apache.spark.ml.linalg.Vectors\n\n","user":"anonymous","dateUpdated":"2019-04-07T14:43:57-0400","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml._\nimport org.apache.spark.ml.linalg.Vectors\n"}]},"apps":[],"jobName":"paragraph_1554176885780_-469829758","id":"20190401-234805_44197473","dateCreated":"2019-04-01T23:48:05-0400","dateStarted":"2019-04-01T23:55:08-0400","dateFinished":"2019-04-01T23:55:08-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34555"},{"text":"%md\n\n#changing all the data to one feature\n","user":"anonymous","dateUpdated":"2019-04-06T23:27:06-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>#changing all the data to one feature</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1554245847308_-1846968361","id":"20190402-185727_1697224434","dateCreated":"2019-04-02T18:57:27-0400","dateStarted":"2019-04-06T23:27:06-0400","dateFinished":"2019-04-06T23:27:09-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34556"},{"text":"%spark\n\nimport org.apache.spark.ml.feature.VectorAssembler\n\nval assembler = new VectorAssembler().setInputCols(colnames).setOutputCol(\"features\")\nval renamed_data = data.withColumnRenamed(\"price\", \"label\")\nval output = assembler.transform(renamed_data).select(\"features\", \"label\")","user":"anonymous","dateUpdated":"2019-04-07T14:44:01-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.feature.VectorAssembler\nassembler: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_f6def6835377\nrenamed_data: org.apache.spark.sql.DataFrame = [id: bigint, label: decimal(7,0) ... 18 more fields]\noutput: org.apache.spark.sql.DataFrame = [features: vector, label: decimal(7,0)]\n"}]},"apps":[],"jobName":"paragraph_1554176885372_1872884186","id":"20190401-234805_1399611941","dateCreated":"2019-04-01T23:48:05-0400","dateStarted":"2019-04-07T14:44:01-0400","dateFinished":"2019-04-07T14:44:01-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34557"},{"text":"%spark\noutput.show()","user":"anonymous","dateUpdated":"2019-04-07T14:44:07-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-------+\n|            features|  label|\n+--------------------+-------+\n|[3.0,1.0,1180.0,5...| 221900|\n|[3.0,2.25,2570.0,...| 538000|\n|[2.0,1.0,770.0,10...| 180000|\n|[4.0,3.0,1960.0,5...| 604000|\n|[3.0,2.0,1680.0,8...| 510000|\n|[4.0,4.5,5420.0,1...|1225000|\n|[3.0,2.25,1715.0,...| 257500|\n|[3.0,1.5,1060.0,9...| 291850|\n|[3.0,1.0,1780.0,7...| 229500|\n|[3.0,2.5,1890.0,6...| 323000|\n|[3.0,2.5,3560.0,9...| 662500|\n|[2.0,1.0,1160.0,6...| 468000|\n|[3.0,1.0,1430.0,1...| 310000|\n|[3.0,1.75,1370.0,...| 400000|\n|[5.0,2.0,1810.0,4...| 530000|\n|[4.0,3.0,2950.0,5...| 650000|\n|[3.0,2.0,1890.0,1...| 395000|\n|[4.0,1.0,1600.0,4...| 485000|\n|[2.0,1.0,1200.0,9...| 189000|\n|[3.0,1.0,1250.0,9...| 230000|\n+--------------------+-------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://10.110.60.241:4040/jobs/job?id=2"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1554402401878_2102788704","id":"20190404-142641_54351529","dateCreated":"2019-04-04T14:26:41-0400","dateStarted":"2019-04-07T14:44:07-0400","dateFinished":"2019-04-07T14:44:08-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34558"},{"text":"%spark\n\nimport org.apache.spark.ml.feature.StandardScaler\n\nval sqlContext = new org.apache.spark.sql.SQLContext(sc)\nimport sqlContext.implicits._\n\nval scaler = (new StandardScaler()\n             .setInputCol(\"features\")\n             .setOutputCol(\"scaledFeatures\")\n             .setWithStd(true)\n             .setWithMean(false))\n","user":"anonymous","dateUpdated":"2019-04-07T14:44:46-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\nimport org.apache.spark.ml.feature.StandardScaler\nsqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@3d1148c1\nimport sqlContext.implicits._\nscaler: org.apache.spark.ml.feature.StandardScaler = stdScal_8c6efd8510c6\n"}]},"apps":[],"jobName":"paragraph_1554176884941_-2143430512","id":"20190401-234804_1538554749","dateCreated":"2019-04-01T23:48:04-0400","dateStarted":"2019-04-07T14:44:46-0400","dateFinished":"2019-04-07T14:44:48-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34559"},{"text":"","user":"anonymous","dateUpdated":"2019-04-04T14:33:31-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554402789292_-1039598027","id":"20190404-143309_1569603556","dateCreated":"2019-04-04T14:33:09-0400","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:34560"},{"text":"%spark\n\nval scalerModel = scaler.fit(output)\n\nval scaledData  = scalerModel.transform(output)","user":"anonymous","dateUpdated":"2019-04-07T14:44:52-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"scalerModel: org.apache.spark.ml.feature.StandardScalerModel = stdScal_8c6efd8510c6\nscaledData: org.apache.spark.sql.DataFrame = [features: vector, label: decimal(7,0) ... 1 more field]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://10.110.60.241:4040/jobs/job?id=3"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1554245619411_1855712343","id":"20190402-185339_339745273","dateCreated":"2019-04-02T18:53:39-0400","dateStarted":"2019-04-07T14:44:52-0400","dateFinished":"2019-04-07T14:44:55-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34561"},{"text":"%spark\n\nscaledData.select(\"scaledFeatures\", \"label\").show()","user":"anonymous","dateUpdated":"2019-04-07T14:44:59-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-------+\n|      scaledFeatures|  label|\n+--------------------+-------+\n|[3.22559199779093...| 221900|\n|[3.22559199779093...| 538000|\n|[2.15039466519395...| 180000|\n|[4.30078933038790...| 604000|\n|[3.22559199779093...| 510000|\n|[4.30078933038790...|1225000|\n|[3.22559199779093...| 257500|\n|[3.22559199779093...| 291850|\n|[3.22559199779093...| 229500|\n|[3.22559199779093...| 323000|\n|[3.22559199779093...| 662500|\n|[2.15039466519395...| 468000|\n|[3.22559199779093...| 310000|\n|[3.22559199779093...| 400000|\n|[5.37598666298488...| 530000|\n|[4.30078933038790...| 650000|\n|[3.22559199779093...| 395000|\n|[4.30078933038790...| 485000|\n|[2.15039466519395...| 189000|\n|[3.22559199779093...| 230000|\n+--------------------+-------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://10.110.60.241:4040/jobs/job?id=4"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1554403675523_-909211196","id":"20190404-144755_470321781","dateCreated":"2019-04-04T14:47:55-0400","dateStarted":"2019-04-07T14:44:59-0400","dateFinished":"2019-04-07T14:45:01-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34562"},{"text":"%spark\n\nimport org.apache.spark.ml.feature.PCA\nimport org.apache.spark.ml.linalg.Vectors\nimport org.apache.spark.sql.SparkSession\n\nval pca = (new PCA()\n           .setInputCol(\"scaledFeatures\")\n           .setOutputCol(\"pcaFeatures\")\n           .setK(4)\n           .fit(scaledData))\n","user":"anonymous","dateUpdated":"2019-04-07T14:47:08-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.feature.PCA\nimport org.apache.spark.ml.linalg.Vectors\nimport org.apache.spark.sql.SparkSession\npca: org.apache.spark.ml.feature.PCAModel = pca_b4b469287d82\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://10.110.60.241:4040/jobs/job?id=5","http://10.110.60.241:4040/jobs/job?id=6","http://10.110.60.241:4040/jobs/job?id=7","http://10.110.60.241:4040/jobs/job?id=8"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1554245621944_-404817572","id":"20190402-185341_1347156039","dateCreated":"2019-04-02T18:53:41-0400","dateStarted":"2019-04-07T14:47:08-0400","dateFinished":"2019-04-07T14:47:13-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34563"},{"text":"%spark\n\nval pcaDF = pca.transform(scaledData).select(\"pcaFeatures\", \"label\")","user":"anonymous","dateUpdated":"2019-04-07T14:47:17-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"pcaDF: org.apache.spark.sql.DataFrame = [pcaFeatures: vector, label: decimal(7,0)]\n"}]},"apps":[],"jobName":"paragraph_1554245618606_-144249099","id":"20190402-185338_1545133777","dateCreated":"2019-04-02T18:53:38-0400","dateStarted":"2019-04-07T14:47:17-0400","dateFinished":"2019-04-07T14:47:18-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34564"},{"text":"%spark\npcaDF.show()","user":"anonymous","dateUpdated":"2019-04-07T14:47:21-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-------+\n|         pcaFeatures|  label|\n+--------------------+-------+\n|[439.220642880795...| 221900|\n|[436.807329262634...| 538000|\n|[439.142867985880...| 180000|\n|[437.793097949543...| 604000|\n|[436.859299199891...| 510000|\n|[429.132447856803...|1225000|\n|[436.448963441326...| 257500|\n|[438.971385362486...| 291850|\n|[438.610749916671...| 229500|\n|[435.732517396031...| 323000|\n|[435.305287714771...| 662500|\n|[439.698604533015...| 468000|\n|[438.372862665377...| 310000|\n|[437.997762852146...| 400000|\n|[437.871436942402...| 530000|\n|[434.569016064733...| 650000|\n|[436.120919665769...| 395000|\n|[438.587417229827...| 485000|\n|[439.430812263070...| 189000|\n|[438.710168284843...| 230000|\n+--------------------+-------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://10.110.60.241:4040/jobs/job?id=9"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1554176883879_940821788","id":"20190401-234803_758313985","dateCreated":"2019-04-01T23:48:03-0400","dateStarted":"2019-04-07T14:47:21-0400","dateFinished":"2019-04-07T14:47:23-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34565"},{"text":"%spark\npca.explainedVariance","user":"anonymous","dateUpdated":"2019-04-07T14:47:35-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res6: org.apache.spark.ml.linalg.DenseVector = [0.29050072051612047,0.12229747466760321,0.10249133758948781,0.07587990617881502]\n"}]},"apps":[],"jobName":"paragraph_1554401030474_-2001145838","id":"20190404-140350_2020204472","dateCreated":"2019-04-04T14:03:50-0400","dateStarted":"2019-04-07T14:47:35-0400","dateFinished":"2019-04-07T14:47:36-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34566"},{"text":"%spark\nval renamed_pca = pcaDF.withColumnRenamed(\"pcaFeatures\", \"features\")","user":"anonymous","dateUpdated":"2019-04-07T14:48:09-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"renamed_pca: org.apache.spark.sql.DataFrame = [features: vector, label: decimal(7,0)]\n"}]},"apps":[],"jobName":"paragraph_1554403509812_-1256008030","id":"20190404-144509_1788298198","dateCreated":"2019-04-04T14:45:09-0400","dateStarted":"2019-04-07T14:48:09-0400","dateFinished":"2019-04-07T14:48:09-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34567"},{"text":"%spark\n\nval Array(training,test) = renamed_pca.randomSplit(Array(0.7,0.3), seed=12345)","user":"anonymous","dateUpdated":"2019-04-07T14:48:12-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"training: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [features: vector, label: decimal(7,0)]\ntest: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [features: vector, label: decimal(7,0)]\n"}]},"apps":[],"jobName":"paragraph_1554401812744_-1081624940","id":"20190404-141652_674326589","dateCreated":"2019-04-04T14:16:52-0400","dateStarted":"2019-04-07T14:48:12-0400","dateFinished":"2019-04-07T14:48:14-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34568"},{"text":"%spark\n\ntraining.show()","user":"anonymous","dateUpdated":"2019-04-07T14:48:17-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-------+\n|            features|  label|\n+--------------------+-------+\n|[417.254894308660...|2280000|\n|[422.031899605964...|6885000|\n|[422.254324434313...|7700000|\n|[422.924662289248...|1600000|\n|[424.792624333883...|2983000|\n|[425.212785643469...|7062500|\n|[425.238526509295...|4668000|\n|[425.408929289604...|2888000|\n|[425.562605010802...|5350000|\n|[425.582932175077...|5570000|\n|[425.673678033695...|5300000|\n|[426.317325218736...|4208000|\n|[426.365771047048...| 900000|\n|[426.484950212611...|1550000|\n|[426.524143071277...|1610000|\n|[426.811410762179...|2238890|\n|[426.965414859200...|3100000|\n|[426.986108385183...|1110000|\n|[427.091732877726...|4500000|\n|[427.132477882503...|3800000|\n+--------------------+-------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://10.110.60.241:4040/jobs/job?id=10"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1554401816972_-516591422","id":"20190404-141656_419961701","dateCreated":"2019-04-04T14:16:56-0400","dateStarted":"2019-04-07T14:48:17-0400","dateFinished":"2019-04-07T14:48:20-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34569"},{"text":"%spark\n\nimport org.apache.spark.ml.regression.LinearRegression\n\nval lr = new LinearRegression()\n             .setMaxIter(10)\n             .setRegParam(0.3)\n             .setElasticNetParam(0.8)\n\n","user":"anonymous","dateUpdated":"2019-04-07T14:48:25-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.regression.LinearRegression\nlr: org.apache.spark.ml.regression.LinearRegression = linReg_a73d152ec2d3\n"}]},"apps":[],"jobName":"paragraph_1554401814225_654480388","id":"20190404-141654_1734967021","dateCreated":"2019-04-04T14:16:54-0400","dateStarted":"2019-04-07T14:48:25-0400","dateFinished":"2019-04-07T14:48:25-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34570"},{"text":"%spark\n\nval lrModel = lr.fit(training)","user":"anonymous","dateUpdated":"2019-04-07T14:48:30-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"lrModel: org.apache.spark.ml.regression.LinearRegressionModel = linReg_a73d152ec2d3\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://10.110.60.241:4040/jobs/job?id=11","http://10.110.60.241:4040/jobs/job?id=12","http://10.110.60.241:4040/jobs/job?id=13","http://10.110.60.241:4040/jobs/job?id=14","http://10.110.60.241:4040/jobs/job?id=15"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1554249031830_360330264","id":"20190402-195031_1346804008","dateCreated":"2019-04-02T19:50:31-0400","dateStarted":"2019-04-07T14:48:30-0400","dateFinished":"2019-04-07T14:48:38-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34571"},{"text":"%spark\n\nval trainingsummary = lrModel.summary\n\ntrainingsummary.r2","user":"anonymous","dateUpdated":"2019-04-07T19:00:15-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"trainingsummary: org.apache.spark.ml.regression.LinearRegressionTrainingSummary = org.apache.spark.ml.regression.LinearRegressionTrainingSummary@5dfb2586\nres23: Double = 0.6052444933222325\n"}]},"apps":[],"jobName":"paragraph_1554403780029_1455712101","id":"20190404-144940_225867021","dateCreated":"2019-04-04T14:49:40-0400","dateStarted":"2019-04-07T19:00:15-0400","dateFinished":"2019-04-07T19:00:15-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34572"},{"text":"%spark\n\nval predictions_lr=lrModel.transform(test)","user":"anonymous","dateUpdated":"2019-04-07T18:47:08-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"predictions_lr: org.apache.spark.sql.DataFrame = [features: vector, label: decimal(7,0) ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1554249439124_-1315892851","id":"20190402-195719_1353243836","dateCreated":"2019-04-02T19:57:19-0400","dateStarted":"2019-04-07T18:47:08-0400","dateFinished":"2019-04-07T18:47:08-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34573"},{"text":"%spark\n\n// Select example rows to display.\npredictions_lr.select(\"prediction\", \"label\", \"features\").show(5)","user":"anonymous","dateUpdated":"2019-04-07T18:48:29-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+-------+--------------------+\n|        prediction|  label|            features|\n+------------------+-------+--------------------+\n|1592643.0714048743| 937500|[424.257596794502...|\n|2034813.3362214267|1488000|[424.582280066331...|\n|1747089.4377576113|1950000|[425.040752615112...|\n| 1660374.679260388|2700000|[425.130602302078...|\n|1711148.7789232582|1600000|[425.730754693030...|\n+------------------+-------+--------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1554607184171_1253572483","id":"20190406-231944_2075222081","dateCreated":"2019-04-06T23:19:44-0400","dateStarted":"2019-04-07T18:48:29-0400","dateFinished":"2019-04-07T18:48:30-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34574"},{"text":"%spark\n\nimport org.apache.spark.ml.evaluation.RegressionEvaluator\n\nval evaluator = new RegressionEvaluator()\n  .setLabelCol(\"label\")\n  .setPredictionCol(\"prediction\")\n  .setMetricName(\"rmse\")\n\nval rmse = evaluator.evaluate(predictions_lr)\n\n\nprintln(s\"RMSE: ${rmse} R-squared: ${trainingsummary.r2}\")\n","user":"anonymous","dateUpdated":"2019-04-07T19:16:29-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"RMSE: 229498.46043963952 R-squared: 0.6052444933222325\nimport org.apache.spark.ml.evaluation.RegressionEvaluator\nevaluator: org.apache.spark.ml.evaluation.RegressionEvaluator = regEval_7b1108b294ef\nrmse: Double = 229498.46043963952\n"}]},"apps":[],"jobName":"paragraph_1554607185949_-679110658","id":"20190406-231945_544476604","dateCreated":"2019-04-06T23:19:45-0400","dateStarted":"2019-04-07T19:16:15-0400","dateFinished":"2019-04-07T19:16:16-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34575"},{"text":"%md\n\n## We want to do tree regression\n","user":"anonymous","dateUpdated":"2019-04-07T19:37:58-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>We want to do tree regression</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1554679656933_-262941438","id":"20190407-192736_131748858","dateCreated":"2019-04-07T19:27:36-0400","dateStarted":"2019-04-07T19:37:58-0400","dateFinished":"2019-04-07T19:37:58-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34576"},{"text":"%spark\n\nimport org.apache.spark.ml.regression.DecisionTreeRegressor\n\n","user":"anonymous","dateUpdated":"2019-04-07T20:19:03-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.regression.DecisionTreeRegressor\n"}]},"apps":[],"jobName":"paragraph_1554607192154_1380341043","id":"20190406-231952_41524530","dateCreated":"2019-04-06T23:19:52-0400","dateStarted":"2019-04-07T20:19:03-0400","dateFinished":"2019-04-07T20:19:03-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34577"},{"text":"%spark\n\nval dt = new DecisionTreeRegressor()\n","user":"anonymous","dateUpdated":"2019-04-07T23:20:18-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"dt: org.apache.spark.ml.regression.DecisionTreeRegressor = dtr_bf3d6a438b87\n"}]},"apps":[],"jobName":"paragraph_1554666249340_1339715417","id":"20190407-154409_1454637901","dateCreated":"2019-04-07T15:44:09-0400","dateStarted":"2019-04-07T23:20:18-0400","dateFinished":"2019-04-07T23:20:19-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34578"},{"text":"%spark\n\nimport org.apache.spark.ml.Pipeline\n\nval pipeline = new Pipeline().setStages(Array(dt))\n\nval variedMaxDepthModels = (0 until 15).map { maxDepth =>\n  // For this setting of maxDepth, learn a decision tree.\n  dt.setMaxDepth(maxDepth)\n  // Create a Pipeline with our feature processing stage (indexer) plus the tree algorithm\n  val pipeline = new Pipeline().setStages(Array(dt))\n  // Run the ML Pipeline to learn a tree.\n  pipeline.fit(training)\n}\n\n\nval tr_model = pipeline.fit(training)\n\n","user":"anonymous","dateUpdated":"2019-04-08T00:03:56-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.Pipeline\npipeline: org.apache.spark.ml.Pipeline = pipeline_fbca6f8532dd\nvariedMaxDepthModels: scala.collection.immutable.IndexedSeq[org.apache.spark.ml.PipelineModel] = Vector(pipeline_5ee8f9e5a6fc, pipeline_f3ccfd3df148, pipeline_a3dd5360030a, pipeline_b8544d7bf0af, pipeline_ca11dda23098, pipeline_f371e4697e53, pipeline_d44647dc7187, pipeline_9c0c78026d7c, pipeline_a1fa468e1917, pipeline_e672a3b93a76, pipeline_fef2d82a220b, pipeline_62fa61b25eea, pipeline_65cb38ffe378, pipeline_adcd61139fa4, pipeline_ffb4cc1fa0ad)\ntr_model: org.apache.spark.ml.PipelineModel = pipeline_fbca6f8532dd\n"}]},"apps":[],"jobName":"paragraph_1554680942523_1944431388","id":"20190407-194902_1791317175","dateCreated":"2019-04-07T19:49:02-0400","dateStarted":"2019-04-08T00:03:56-0400","dateFinished":"2019-04-08T00:04:14-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34579"},{"text":"%spark\n\nval evaluator = new RegressionEvaluator()\n  .setLabelCol(\"label\")\n  .setPredictionCol(\"prediction\")\n  .setMetricName(\"rmse\")\n\n","user":"anonymous","dateUpdated":"2019-04-08T00:04:18-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"evaluator: org.apache.spark.ml.evaluation.RegressionEvaluator = regEval_aa6cc56cf1d6\n"}]},"apps":[],"jobName":"paragraph_1554685898677_-519833724","id":"20190407-211138_473615665","dateCreated":"2019-04-07T21:11:38-0400","dateStarted":"2019-04-08T00:04:18-0400","dateFinished":"2019-04-08T00:04:19-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34580"},{"text":"%spark\n\nval accuracies = (0 until 15).map { maxDepth =>\n  val model = variedMaxDepthModels(maxDepth)\n  // Calling transform() on the test set runs the fitted pipeline.\n  // The learned model makes predictions on each test example.\n  val predictions = model.transform(test)\n  // Calling evaluate() on the predictions DataFrame computes our accuracy metric.\n  (maxDepth, evaluator.evaluate(predictions))\n}.toDF(\"maxDepth\", \"accuracy\")\n\n","user":"anonymous","dateUpdated":"2019-04-08T00:04:21-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"accuracies: org.apache.spark.sql.DataFrame = [maxDepth: int, accuracy: double]\n"}]},"apps":[],"jobName":"paragraph_1554696058039_1201339075","id":"20190408-000058_1469041585","dateCreated":"2019-04-08T00:00:58-0400","dateStarted":"2019-04-08T00:04:21-0400","dateFinished":"2019-04-08T00:04:25-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34581"},{"text":"%spark\n\naccuracies.collect.foreach(println)\n","user":"anonymous","dateUpdated":"2019-04-08T00:04:26-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[0,356961.9158905334]\n[1,299247.0859000683]\n[2,272390.53621844045]\n[3,246751.9887580915]\n[4,233394.3462471204]\n[5,230386.75716071634]\n[6,234734.66654581792]\n[7,243812.8877184329]\n[8,249628.05519191327]\n[9,261236.0434510245]\n[10,266792.61182598793]\n[11,271586.4228343649]\n[12,276402.197429339]\n[13,282475.50863804173]\n[14,288535.20175858575]\n"}]},"apps":[],"jobName":"paragraph_1554696117184_1776329847","id":"20190408-000157_641922549","dateCreated":"2019-04-08T00:01:57-0400","dateStarted":"2019-04-08T00:04:26-0400","dateFinished":"2019-04-08T00:04:26-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34582"},{"text":"%spark\n\nimport org.apache.spark.ml.regression.{RandomForestRegressionModel, RandomForestRegressor}\n\nval rf = new RandomForestRegressor()\n\nval pipeline = new Pipeline().setStages(Array(rf))\n\nval variedMaxDepthModels = (0 until 15).map { maxDepth =>\n  // For this setting of maxDepth, learn a decision tree.\n  rf.setMaxDepth(maxDepth)\n  // Create a Pipeline with our feature processing stage (indexer) plus the tree algorithm\n  val pipeline = new Pipeline().setStages(Array(rf))\n  // Run the ML Pipeline to learn a tree.\n  pipeline.fit(training)\n}\n\n\nval rf_model = pipeline.fit(training)\n\n\n","user":"anonymous","dateUpdated":"2019-04-08T01:08:42-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.regression.{RandomForestRegressionModel, RandomForestRegressor}\nrf: org.apache.spark.ml.regression.RandomForestRegressor = rfr_35dcab86510f\npipeline: org.apache.spark.ml.Pipeline = pipeline_1d768d0081bc\nvariedMaxDepthModels: scala.collection.immutable.IndexedSeq[org.apache.spark.ml.PipelineModel] = Vector(pipeline_961fba491c02, pipeline_270df20853a7, pipeline_459fa6165d3e, pipeline_f70d11e00510, pipeline_0084e39bc1bc, pipeline_ce0afc07c8c2, pipeline_2a3d2a61e844, pipeline_474004bf62e2, pipeline_d9906d326eca, pipeline_e4285a063c09, pipeline_25dc0c3cee2e, pipeline_87cfaae04e5d, pipeline_d6293b38f62b, pipeline_cea62760841a, pipeline_6afaf27601a3)\nrf_model: org.apache.spark.ml.PipelineModel = pipeline_1d768d0081bc\n"}]},"apps":[],"jobName":"paragraph_1554696190727_-1103006510","id":"20190408-000310_2107112163","dateCreated":"2019-04-08T00:03:10-0400","dateStarted":"2019-04-08T01:08:42-0400","dateFinished":"2019-04-08T01:09:31-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34583"},{"text":"%spark\n\n\nval accuracies = (0 until 15).map { maxDepth =>\n  val model = variedMaxDepthModels(maxDepth)\n  // Calling transform() on the test set runs the fitted pipeline.\n  // The learned model makes predictions on each test example.\n  val predictions = model.transform(test)\n  // Calling evaluate() on the predictions DataFrame computes our accuracy metric.\n  (maxDepth, evaluator.evaluate(predictions))\n}.toDF(\"maxDepth\", \"accuracy\")\n\n","user":"anonymous","dateUpdated":"2019-04-08T01:09:55-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"accuracies: org.apache.spark.sql.DataFrame = [maxDepth: int, accuracy: double]\n"}]},"apps":[],"jobName":"paragraph_1554698149365_998947521","id":"20190408-003549_1102957994","dateCreated":"2019-04-08T00:35:49-0400","dateStarted":"2019-04-08T01:09:55-0400","dateFinished":"2019-04-08T01:10:00-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34584"},{"text":"%spark\n\naccuracies.collect.foreach(println)","user":"anonymous","dateUpdated":"2019-04-08T01:10:05-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[0,356964.12552401045]\n[1,290087.06237481313]\n[2,259368.8314553357]\n[3,242030.07011989306]\n[4,230263.13825708374]\n[5,221948.18505781773]\n[6,217831.78066834336]\n[7,214956.9217260884]\n[8,212916.96760056258]\n[9,212288.5789951285]\n[10,211519.54842848514]\n[11,211293.90672683332]\n[12,211590.14100326505]\n[13,212335.2815518787]\n[14,212842.72932683566]\n"}]},"apps":[],"jobName":"paragraph_1554698400236_-25933631","id":"20190408-004000_1599998378","dateCreated":"2019-04-08T00:40:00-0400","dateStarted":"2019-04-08T01:10:05-0400","dateFinished":"2019-04-08T01:10:05-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34585"},{"text":"%spark\n\nimport org.apache.spark.ml.regression.{GBTRegressionModel, GBTRegressor}\n\nval xg = new GBTRegressor()\n         .setMaxIter(10)\n","user":"anonymous","dateUpdated":"2019-04-08T01:10:17-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.regression.{GBTRegressionModel, GBTRegressor}\nxg: org.apache.spark.ml.regression.GBTRegressor = gbtr_1af5fbae8ce3\n"}]},"apps":[],"jobName":"paragraph_1554698448556_-1062273239","id":"20190408-004048_1995857062","dateCreated":"2019-04-08T00:40:48-0400","dateStarted":"2019-04-08T01:10:17-0400","dateFinished":"2019-04-08T01:10:17-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34586"},{"text":"%spark\n\nval pipeline = new Pipeline().setStages(Array(xg))\n\nval variedMaxDepthModels = (0 until 15).map { maxDepth =>\n  // For this setting of maxDepth, learn a decision tree.\n  xg.setMaxDepth(maxDepth)\n  // Create a Pipeline with our feature processing stage (indexer) plus the tree algorithm\n  val pipeline = new Pipeline().setStages(Array(xg))\n  // Run the ML Pipeline to learn a tree.\n  pipeline.fit(training)\n}\n\n\nval xg_model = pipeline.fit(training)","user":"anonymous","dateUpdated":"2019-04-08T01:10:50-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"pipeline: org.apache.spark.ml.Pipeline = pipeline_9b3a49ce1be3\nvariedMaxDepthModels: scala.collection.immutable.IndexedSeq[org.apache.spark.ml.PipelineModel] = Vector(pipeline_5e45c307e13d, pipeline_286297953449, pipeline_931f3ae91c97, pipeline_286c8aa7220c, pipeline_ba6eda91ec65, pipeline_a4d873fc2ae3, pipeline_5b651b0eaf05, pipeline_8370c487d352, pipeline_130a56ce7f4d, pipeline_f4998897bfdf, pipeline_e898143891a5, pipeline_12ab5815bd76, pipeline_823f6076b1d3, pipeline_759d97f9e6db, pipeline_f211345c8ef7)\nxg_model: org.apache.spark.ml.PipelineModel = pipeline_9b3a49ce1be3\n"}]},"apps":[],"jobName":"paragraph_1554699521885_1523272063","id":"20190408-005841_1215784606","dateCreated":"2019-04-08T00:58:41-0400","dateStarted":"2019-04-08T01:10:50-0400","dateFinished":"2019-04-08T01:12:31-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34587"},{"text":"%spark\n\nval accuracies = (0 until 15).map { maxDepth =>\n  val model = variedMaxDepthModels(maxDepth)\n  // Calling transform() on the test set runs the fitted pipeline.\n  // The learned model makes predictions on each test example.\n  val predictions = model.transform(test)\n  // Calling evaluate() on the predictions DataFrame computes our accuracy metric.\n  (maxDepth, evaluator.evaluate(predictions))\n}.toDF(\"maxDepth\", \"accuracy\")\n\n","user":"anonymous","dateUpdated":"2019-04-08T01:14:15-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"accuracies: org.apache.spark.sql.DataFrame = [maxDepth: int, accuracy: double]\n"}]},"apps":[],"jobName":"paragraph_1554699864481_1930731737","id":"20190408-010424_1323864987","dateCreated":"2019-04-08T01:04:24-0400","dateStarted":"2019-04-08T01:14:15-0400","dateFinished":"2019-04-08T01:14:20-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34588"},{"text":"%spark\n\naccuracies.collect.foreach(println)","user":"anonymous","dateUpdated":"2019-04-08T01:14:47-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[0,356961.9158905334]\n[1,263609.88756539]\n[2,245293.48038231183]\n[3,232780.7059452962]\n[4,225691.91868319697]\n[5,221547.34626363998]\n[6,228743.8396740869]\n[7,225336.7370186273]\n[8,237567.87956415684]\n[9,246804.32712692983]\n[10,258796.34363861888]\n[11,263463.46863552416]\n[12,270811.44781411975]\n[13,276927.0144495231]\n[14,283298.4595241919]\n"}]},"apps":[],"jobName":"paragraph_1554700455795_1934724624","id":"20190408-011415_651200034","dateCreated":"2019-04-08T01:14:15-0400","dateStarted":"2019-04-08T01:14:47-0400","dateFinished":"2019-04-08T01:14:47-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34589"},{"text":"%spark\n\nimport org.apache.spark.ml.regression.GeneralizedLinearRegression\n\nval glr_gaussian = new GeneralizedLinearRegression()\n  .setFamily(\"gaussian\")\n  .setLink(\"identity\")\n  .setMaxIter(10)\n  .setRegParam(0.3)\n\n","user":"anonymous","dateUpdated":"2019-04-08T01:23:03-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.regression.GeneralizedLinearRegression\nglr_gaussian: org.apache.spark.ml.regression.GeneralizedLinearRegression = glm_488dcbfbe27e\n"}]},"apps":[],"jobName":"paragraph_1554700487558_225605255","id":"20190408-011447_1057421571","dateCreated":"2019-04-08T01:14:47-0400","dateStarted":"2019-04-08T01:23:03-0400","dateFinished":"2019-04-08T01:23:04-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34590"},{"text":"%spark\n\nval pipeline = new Pipeline().setStages(Array(glr_gaussian))\n\nval glr_model = pipeline.fit(training)\n\nval predictions = glr_model.transform(test)","user":"anonymous","dateUpdated":"2019-04-08T01:29:40-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"pipeline: org.apache.spark.ml.Pipeline = pipeline_92a5ff96c35f\nglr_model: org.apache.spark.ml.PipelineModel = pipeline_92a5ff96c35f\npredictions: org.apache.spark.sql.DataFrame = [features: vector, label: decimal(7,0) ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1554700983835_908934731","id":"20190408-012303_225718847","dateCreated":"2019-04-08T01:23:03-0400","dateStarted":"2019-04-08T01:29:40-0400","dateFinished":"2019-04-08T01:29:41-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34591"},{"text":"%spark\n\nval rmse_glr_models = (evaluator.evaluate(predictions))\n\nprintln(s\"RMSE: ${rmse}\")\n\n\n","user":"anonymous","dateUpdated":"2019-04-08T01:34:33-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"RMSE: 229498.46043963952\nrmse_glr_models: Double = 229498.4739081894\n"}]},"apps":[],"jobName":"paragraph_1554701060246_-989368743","id":"20190408-012420_1944373556","dateCreated":"2019-04-08T01:24:20-0400","dateStarted":"2019-04-08T01:34:33-0400","dateFinished":"2019-04-08T01:34:34-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34592"},{"text":"%spark\n\nval gamma_gaussian = new GeneralizedLinearRegression()\n  .setFamily(\"gamma\")\n  .setLink(\"identity\")\n  .setMaxIter(10)\n  .setRegParam(0.3)\n\nval pipeline = new Pipeline().setStages(Array(gamma_gaussian))\n\nval gamma_gaussian_model = pipeline.fit(training)\n\nval predictions = gamma_gaussian_model.transform(test)\n\nval rmse_gamma_gaussian = (evaluator.evaluate(predictions))\n\nprintln(s\"RMSE: ${rmse}\")\n","user":"anonymous","dateUpdated":"2019-04-08T01:40:52-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"RMSE: 229498.46043963952\ngamma_gaussian: org.apache.spark.ml.regression.GeneralizedLinearRegression = glm_4dc72c4b5239\npipeline: org.apache.spark.ml.Pipeline = pipeline_c74091c745f2\ngamma_gaussian_model: org.apache.spark.ml.PipelineModel = pipeline_c74091c745f2\npredictions: org.apache.spark.sql.DataFrame = [features: vector, label: decimal(7,0) ... 1 more field]\nrmse_gamma_gaussian: Double = 455460.87390938896\n"}]},"apps":[],"jobName":"paragraph_1554701412276_773130863","id":"20190408-013012_744620279","dateCreated":"2019-04-08T01:30:12-0400","dateStarted":"2019-04-08T01:40:52-0400","dateFinished":"2019-04-08T01:40:54-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34593"},{"text":"%spark\n","user":"anonymous","dateUpdated":"2019-04-08T01:39:33-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554701973774_-1469764273","id":"20190408-013933_1894519638","dateCreated":"2019-04-08T01:39:33-0400","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:34594"}],"name":"pca","id":"2E9W6NYFK","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}